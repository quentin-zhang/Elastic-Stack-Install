# 7.redis并发竞争

1.并发竞争的原因：多个客户端同时并发写了一个key，应该先到的数据，后来才到，导致数据版本错误，或者多个客户端同时获取一个key，修改之后再写回去，只要顺序错了，数据就出错了
2.解决方案：CAS类的乐观锁方案

- 比如采用zookeeper实现分布式锁；每个系统通过zookeeper获取分布式锁，确保同一时间，只能有一个系统实例在操作某个key，别人都不允许读和写
- 写入mysql的数据，必须带有updateTime，查询的时候必然能查出这个时间戳；每次写入之前，先判断当前这个value的时间戳是否比缓存里的value的时间戳要新，如果是的话，可以写。
